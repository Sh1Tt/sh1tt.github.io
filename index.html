<!DOCTYPE html lang="en">
  <head>
    <meta http-equiv="Content-Type" Content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0 maximum-scale=1.0, viewport-fit=cover" />
    <title>new pages page</title>
  </head>
  <body>
    <script type="text/javascript">
      
      const base = 'https://api.binance.com/';
      const route = 'api/v3/ticker/24hr?symbol=';
      
      const params =
      { 
        interval: 10000,
        symbols: [
          'CAKEBTC',
          'RUNEBTC',
          'ICPBTC'
        ]
      }

      const getTick = async symbol =>
      {
        if ( typeof( symbol ) === undefined || symbol === 'undefined') return
        
        const avgPrice = document.body.querySelector( `[data-price="${symbol}"]` );
        const changePercent = document.body.querySelector ( `[data-change="${symbol}"]` );
        
        const endpoint = base + route + symbol;
        const data = await fetch( endpoint, { method: 'get' } );
        const response = await data.json();
        const { weightedAvgPrice, priceChangePercent } = response;
        // parent.innerHTML += `
        //   <div id="exchange" class="container">
        //     <div id="${symbol}" class="crypto">
        //       <h3>
        //         ${symbol}
        //       </h3>
        //       <h3 class="avg">
        //         ${weightedAvgPrice}
        //       </h3>
        //       <h3 class="change percent">
        //         ${priceChangePercent}
        //       </h3>
        //     </div>
        //   </div>
        // `;
        //return response;
        avgPrice.innerText = weightedAvgPrice;
        changePercent.innerText = priceChangePercent;
        return
      }

      const step = interval => { setTimeout( update(), interval ); }

      const update = () =>
      {
        params.symbols.forEach( symbol =>
        {
          getTick( symbol );
        });
        // step( params.interval );
        return
      }

      document.addEventListener('DOMContentLoaded', () =>
      {
        const app = document.createElement( 'div');
        document.body.appendChild( app );
        
        params.symbols.forEach( symbol =>
        {
          const __crypto = document.createElement( 'div' );
          app.appendChild( __crypto );
          crypto.innerHTML = `
            <h3>${symbol}</h3>
            <h3 data-price="${symbol}" data-price>0.00000000</h3>
            <h3 data-change="${symbol}">0.00%</h3>
          `;
          
        });
        update();
      }, true );
    </script>
  </body>
</html>
